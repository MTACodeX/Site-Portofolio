---
import { Icon } from "astro-icon/components";

interface Props {
  title: string;
  description?: string;
  tags?: string[];
  href: string;
  image?: any;
}

const { title, description, tags = [], href, image } = Astro.props;

const badgeClass = (tag: string) => {
  const t = tag.toLowerCase();

  if (t.includes("forensic")) return "badge badge--green";
  if (t.includes("web")) return "badge badge--cyan";
  if (t.includes("reverse")) return "badge badge--purple";
  if (t.includes("mobile")) return "badge badge--amber";
  if (t.includes("crypto")) return "badge badge--amber";
  if (t.includes("pwn") || t.includes("binary")) return "badge badge--amber";

  if (t.includes("easy")) return "badge badge--green";
  if (t.includes("medium")) return "badge badge--amber";
  if (t.includes("hard") || t.includes("insane")) return "badge badge--purple";

  return "badge";
};
---

<a class="wizCard" href={href}>
  <div class="wizHeader">
    <div class="wizTitle">Projects</div>

    <div class="wizWinBtns">
      <Icon name="mdi:window-minimize" class="winIcon" />
      <Icon name="mdi:window-maximize" class="winIcon" />
      <Icon name="mdi:close" class="winIcon winClose" />
    </div>
  </div>

  <div class="wizBody">
    {image && (
      <div class="chImageWrapper">
        <img src={image.default.src} alt={title} class="chImage" />
      </div>
    )}

    <div class="chContent">
      <div class="chTitle">{title}</div>

      {description && (
        <p class="chDesc">{description}</p>
      )}
    </div>

    {tags.length > 0 && (
      <div class="chTags">
        {tags.map((tag) => (
          <span class={badgeClass(tag)}>{tag}</span>
        ))}
      </div>
    )}

    <div class="scanlines"></div>
  </div>
</a>

<style>
.wizCard{
  display:flex;
  flex-direction:column;
  text-decoration:none;
  color:inherit;
  border:1px solid rgba(255,255,255,.08);
  background:rgba(12,16,28,.55);
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  transition:.15s ease;
  overflow:hidden;
  position:relative;
  height:100%;
}

.wizCard:hover{
  transform:translateY(-3px);
  border-color:rgba(255,255,255,.18);
  background:rgb(12,16,28);
}

/* Header */
.wizHeader{
  height:44px;
  display:flex;
  align-items:center;
  padding:0 12px;
  background:rgba(255,255,255,.05);
  border-bottom:1px solid rgba(255,255,255,.08);
}

.wizTitle{
  font-size:1rem;
  color:rgba(255,255,255,.75);
}

.wizWinBtns{
  margin-left:auto;
  display:flex;
  gap:10px;
}

.winIcon{
  width:16px;
  height:16px;
  opacity:.6;
  transition:.15s;
}

.winIcon:hover{
  opacity:1;
  transform:translateY(-1px);
}

.winClose:hover{
  color:#ef4444;
}

/* Body */
.wizBody{
  position:relative;
  padding:16px;
  display:flex;
  flex-direction:column;
  flex:1;
}

/* Image */
.chImageWrapper{
  width:100%;
  margin-bottom:12px;
  overflow:hidden;
  border-radius:8px;
}

.chImage{
  width:100%;
  aspect-ratio:16/9;
  object-fit:cover;
  display:block;
  transition:transform .3s ease;
}

.wizCard:hover .chImage{
  transform:scale(1.05);
}

/* Content wrapper agar tinggi stabil */
.chContent{
  flex-grow:1;
}

/* Title max 2 lines */
.chTitle{
  font-size:1.25rem;
  font-weight: bold;
  color: rgba(245, 158, 11, 0.95);
  line-height:1.2;

  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}

/* Description max 3 lines */
.chDesc{
  margin-top:8px;
  font-size:1rem;
  color:rgba(255,255,255,.65);
  line-height:1.4;

  display:-webkit-box;
  -webkit-line-clamp:3;
  -webkit-box-orient:vertical;
  overflow:hidden;
}

/* Tags selalu di bawah */
.chTags{
  margin-top:12px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

/* Badge */
.badge{
  display:inline-block;
  padding:5px 10px;
  font-size:.85rem;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.05);
  color:rgba(255,255,255,.8);
}

.badge--green{
  background:rgba(34,197,94,.15);
  border-color:rgba(34,197,94,.35);
}

.badge--cyan{
  background:rgba(6,182,212,.15);
  border-color:rgba(6,182,212,.35);
}

.badge--purple{
  background:rgba(168,85,247,.15);
  border-color:rgba(168,85,247,.35);
}

.badge--amber{
  background:rgba(245,158,11,.15);
  border-color:rgba(245,158,11,.35);
}

/* Scanlines */
.scanlines{
  pointer-events:none;
  position:absolute;
  inset:0;
  opacity:.12;
  background:repeating-linear-gradient(
    180deg,
    rgba(255,255,255,0.05) 0px,
    rgba(255,255,255,0.05) 1px,
    transparent 1px,
    transparent 6px
  );
}

/* Mobile */
@media (max-width:480px){
  .wizTitle{font-size:1rem;}
  .chTitle{font-size:1.1rem;}
  .chDesc{font-size:0.8rem;}
  .badge{font-size:0.8rem;}
}
</style>
